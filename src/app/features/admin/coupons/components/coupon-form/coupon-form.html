<h2 class="text-xl font-semibold mb-5 text-gray-800">
  {{ data ? 'Edit Coupon' : 'Add Coupon' }}
</h2>

<form [formGroup]="form" (ngSubmit)="save()" class="space-y-5">
  @if (!data) {
    <!-- Only show name when creating -->
    <div>
      <label class="block text-gray-700 mb-1">Coupon Name</label>
      <input
        formControlName="name"
        type="text"
        placeholder="Enter coupon name"
        class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"
      />
      @if (form.get('name')?.touched && form.get('name')?.invalid) {
        <p class="text-red-500 text-sm mt-1">Name is required (min 2 chars)</p>
      }
    </div>
  }

  <div>
    <label class="block text-gray-700 mb-1">Discount (%)</label>
    <input
      formControlName="discount"
      type="number"
      min="1"
      max="100"
      placeholder="Enter discount"
      class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"
    />
    @if (form.get('discount')?.touched && form.get('discount')?.invalid) {
      <p class="text-red-500 text-sm mt-1">
        Discount must be between 1 and 100
      </p>
    }
  </div>

  <div>
    <label class="block text-gray-700 mb-1">Expiry Date</label>
    <input
      formControlName="expiryDate"
      type="date"
      [min]="minDate"
      class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"
    />
    @if (form.get('expiryDate')?.touched && form.get('expiryDate')?.hasError('pastDate')) {
      <p class="text-red-500 text-sm mt-1">
        Expiry date cannot be in the past
      </p>
    }
  </div>

  <div class="flex justify-end gap-3 pt-5 border-t">
    <button
      type="button"
      (click)="close.emit({ updated: false })"
      class="px-4 py-2 border rounded-lg hover:bg-gray-100 transition"
    >
      Cancel
    </button>

    <button
      type="submit"
      [disabled]="form.invalid || loading"
      class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition disabled:opacity-60"
    >
      @if (loading) {
        {{ data ? 'Updating...' : 'Creating...' }}
      } @else {
        {{ data ? 'Update' : 'Create' }}
      }
    </button>
  </div>
</form>
