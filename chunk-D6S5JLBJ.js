import{a as J}from"./chunk-5GTVF6RZ.js";import{a as N,c as k,g as j,i as U,l as W,m as A,n as B,p as z,t as Q,v as G}from"./chunk-BB2RL6FD.js";import{A as y,Aa as q,B as a,E as P,Ga as F,I as g,Ma as O,U as d,V as o,W as n,X as _,Y as h,Z as v,_ as c,a as S,aa as D,b as I,ba as s,ca as f,da as E,ea as C,fa as b,ga as w,q as x,r as u,s as m,t as T,va as M,wa as V}from"./chunk-2AKTDUK2.js";function R(i,t){i&1&&(o(0,"div",3),_(1,"div",4),n())}function H(i,t){if(i&1){let e=h();o(0,"img",24),v("click",function(){let r=u(e).$implicit,p=c(3);return m(p.selectImage(r))}),n()}if(i&2){let e=t.$implicit,l=c(3);D("border-blue-500",e===l.selectedImage),d("src",e,y)}}function K(i,t){if(i&1&&(o(0,"div",22),g(1,H,1,3,"img",23),n()),i&2){let e=c(2);a(),d("ngForOf",e.product.imageUrls)}}function X(i,t){if(i&1&&(o(0,"option",25),s(1),n()),i&2){let e=t.$implicit;d("value",e),a(),f(e)}}function Y(i,t){i&1&&(o(0,"span"),s(1,"Add to Cart"),n())}function Z(i,t){i&1&&(T(),o(0,"svg",26),_(1,"circle",27)(2,"path",28),n())}function $(i,t){if(i&1){let e=h();o(0,"div",5)(1,"div")(2,"div",6),_(3,"img",7),n(),g(4,K,2,1,"div",8),n(),o(5,"div",9)(6,"h2",10),s(7),n(),o(8,"p",11),s(9),n(),o(10,"p",12),s(11),n(),o(12,"p",13),s(13," Category: "),o(14,"span",14),s(15),n()(),o(16,"label",15),s(17,"Color:"),n(),o(18,"select",16),w("ngModelChange",function(r){u(e);let p=c();return b(p.selectedColor,r)||(p.selectedColor=r),m(r)}),g(19,X,2,2,"option",17),n(),o(20,"label",15),s(21,"Quantity:"),n(),o(22,"input",18),w("ngModelChange",function(r){u(e);let p=c();return b(p.quantity,r)||(p.quantity=r),m(r)}),v("input",function(){u(e);let r=c();return m(r.onQuantityChange(r.product))}),n(),o(23,"button",19),v("click",function(){u(e);let r=c();return m(r.addToCart())}),g(24,Y,2,0,"span",20)(25,Z,3,0,"svg",21),n()()()}if(i&2){let e=c();a(3),d("src",e.selectedImage,y)("alt",e.product.title),a(),d("ngIf",e.product.imageUrls==null?null:e.product.imageUrls.length),a(3),f(e.product.title),a(2),f(e.product.description),a(2),E("",e.product.price," EGP"),a(4),f((e.product.category==null?null:e.product.category.name)||"Uncategorized"),a(3),C("ngModel",e.selectedColor),a(),d("ngForOf",e.product.colors),a(3),C("ngModel",e.quantity),a(),d("disabled",e.addingToCart),a(),d("ngIf",!e.addingToCart),a(),d("ngIf",e.addingToCart)}}var L=class i{route=x(F);productService=x(J);toast=x(G);product;loading=!0;selectedImage=null;selectedColor=null;quantity=1;addingToCart=!1;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&(this.loading=!0,this.productService.getProductsById(t).subscribe({next:e=>{this.product=e.data||e.product,this.selectedImage=this.product?.imageCoverUrl,this.selectedColor=this.product?.colors?.[0]||"Default",this.loading=!1},error:e=>{console.error("Error loading product:",e),this.toast.show("Failed to load product details","error"),this.loading=!1}}))}selectImage(t){this.selectedImage=t}addToCart(){if(!this.product||this.addingToCart)return;this.addingToCart=!0;let t=this.selectedColor||"Default";this.productService.addToCart(this.product.id,t,this.quantity).subscribe({next:()=>{this.toast.show(`${this.product.title} added to cart successfully!`,"success"),this.addingToCart=!1;let e=JSON.parse(localStorage.getItem("cart")||"[]"),l=e.find(r=>r.id===this.product.id&&r.color===t);l?l.quantity+=this.quantity:e.push(I(S({},this.product),{color:t,quantity:this.quantity})),localStorage.setItem("cart",JSON.stringify(e))},error:e=>{console.error("Failed to add to cart:",e),this.toast.show("Failed to add product to cart. Please check login or permissions.","error"),this.addingToCart=!1}})}onQuantityChange(t){(t.quantity<1||!t.quantity)&&(t.quantity=1)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-product-details"]],decls:3,vars:2,consts:[[1,"py-10"],["class","flex justify-center py-10",4,"ngIf"],["class","max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-10 px-4",4,"ngIf"],[1,"flex","justify-center","py-10"],[1,"h-10","w-10","border-4","border-blue-500","border-t-transparent","rounded-full","animate-spin"],[1,"max-w-6xl","mx-auto","grid","grid-cols-1","md:grid-cols-2","gap-10","px-4"],[1,"border","rounded-xl","overflow-hidden","mb-4"],[1,"w-full","h-96","object-cover",3,"src","alt"],["class","flex space-x-3 overflow-x-auto pb-2",4,"ngIf"],[1,"flex","flex-col"],[1,"text-3xl","font-semibold","text-gray-800","mb-4"],[1,"text-gray-600","mb-4","leading-relaxed"],[1,"text-2xl","text-blue-600","font-semibold","mb-4"],[1,"text-sm","text-gray-500","mb-6"],[1,"font-medium","text-gray-700"],[1,"text-sm","font-medium","text-gray-700","mb-1"],[1,"mb-3","border","border-gray-300","rounded","px-3","py-2","focus:ring-2","focus:ring-blue-400","focus:outline-none",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["type","number","min","1",1,"mb-6","border","border-gray-300","rounded","px-3","py-2","focus:ring-2","focus:ring-blue-400","focus:outline-none","w-24",3,"ngModelChange","input","ngModel"],[1,"bg-blue-600","text-white","px-6","py-3","rounded-lg","hover:bg-blue-700","transition","flex","justify-center","items-center","font-semibold","w-full","sm:w-auto","cursor-pointer",3,"click","disabled"],[4,"ngIf"],["class","animate-spin h-5 w-5 text-white","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",4,"ngIf"],[1,"flex","space-x-3","overflow-x-auto","pb-2"],["class","h-20 w-20 object-cover rounded-md border cursor-pointer hover:opacity-80 transition",3,"src","border-blue-500","click",4,"ngFor","ngForOf"],[1,"h-20","w-20","object-cover","rounded-md","border","cursor-pointer","hover:opacity-80","transition",3,"click","src"],[3,"value"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 00-8 8h4l-3 3 3 3H4z",1,"opacity-75"]],template:function(e,l){e&1&&(o(0,"section",0),g(1,R,2,0,"div",1)(2,$,26,13,"div",2),n()),e&2&&(a(),d("ngIf",l.loading),a(),d("ngIf",!l.loading&&l.product))},dependencies:[q,M,V,O,Q,A,B,N,U,W,k,z,j],encapsulation:2})};export{L as ProductDetailsComponent};
